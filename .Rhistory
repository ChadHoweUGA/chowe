#########
## 1. Run this first
Sys.setenv("CORPUS_REGISTRY" = "/Volumes/cwb_registry/mac_registry")
library(polmineR)
corpus()
b <- cooccurrences("BNC","bachelor")
head(b,10)
uninteresting  <- c("bachelor","spinster","``","''",punctuation,tm::stopwords("en"))
bach <- cooccurrences("BNC", query = "bachelor", right = 5, left = 5) %>% subset(!tolower(word) %in% uninteresting)
spin <- cooccurrences("BNC", query = "spinster", right = 5, left = 5) %>% subset(!tolower(word) %in% uninteresting)
library(ggplot2)
ggplot(bach@stat[1:14],aes(x=ll,y=reorder(word,-rank_ll))) + geom_point(color="blue") +
labs(title="\"bachelor\" in BNC",x="log-likelihood",y="collocate")
ggplot(spin@stat[1:14],aes(x=ll,y=reorder(word,-rank_ll))) + geom_point(color="red") +
labs(title="\"spinster\" in BNC",x="log-likelihood",y="collocate")
ggplot(bach@stat[1:14],aes(x=ll,y=reorder(word,-rank_ll))) + geom_point(color="blue") +
labs(title="\"bachelor\" in BNC",x="log-likelihood",y="collocate")
bigrams  <- ngrams("BNC",n=2)
greater1k  <-  subset(bigrams, count > 1000 & !(word_1 %in% uninteresting | word_2 %in% uninteresting))
head(sort(greater1k,by="count",decreasing=T),10)
academic  <-  partition("BNC", text_derived_type = "academic")
spoken  <-  partition("BNC", text_derived_type = "spoken_conversation")
oneofthe_acad <- cooccurrences(academic,  query = "'one' 'of' 'the'", cqp = T, right = 1, left = 0) %>% subset(!tolower(word) %in% uninteresting)
oneofthe_spok <- cooccurrences(spoken,  query = "'one' 'of' 'the'", cqp = T, right = 1, left = 0) %>% subset(!tolower(word) %in% uninteresting)
common  <-  intersect(oneofthe_acad@stat[1:10,word],oneofthe_spok@stat[1:10,word])
distinctive  <-  setdiff(oneofthe_acad@stat[1:10,word],common)
head(oneofthe_spok@stat)
head(oneofthe_spok@stat)
head(oneofthe_acad@stat[word %in% distinctive,])
exit
